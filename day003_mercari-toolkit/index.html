<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>メルカリツールキット | tiny-tools Day 3</title>
  <meta name="description" content="メルカリ出品を効率化する5つのツール。テンプレート生成・送料計算・サイズ判定・タイトルチェック・写真トリミング。">
  <meta property="og:title" content="メルカリツールキット | tiny-tools Day 3">
  <meta property="og:description" content="メルカリ出品を効率化する5つのツール。テンプレート生成・送料計算・サイズ判定・タイトルチェック・写真トリミング。">
  <meta property="og:type" content="website">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <link rel="stylesheet" href="style.css">
  <script src="../shared/header.js" data-repo="https://github.com/sanasuke/tiny-tools" data-note="https://note.com/sana_suke"></script>
</head>
<body>
  <!-- Overlay for mobile sidebar -->
  <div class="overlay" id="overlay"></div>

  <div class="app-wrapper">
    <!-- Sidebar -->
    <nav class="sidebar" id="sidebar">
      <ul class="sidebar-nav">
        <li><a href="#template" class="active" data-tab="template"><span class="tab-icon">&#128221;</span>テンプレート生成</a></li>
        <li><a href="#shipping" data-tab="shipping"><span class="tab-icon">&#128230;</span>送料・利益計算</a></li>
        <li><a href="#title" data-tab="title"><span class="tab-icon">&#128394;</span>タイトル文字数</a></li>
        <li><a href="#photo" data-tab="photo"><span class="tab-icon">&#128247;</span>写真トリミング</a></li>
      </ul>
    </nav>

    <!-- Content Area -->
    <main class="content-area">
      <!-- ============================================================
           Tab 1: Template Generator
           ============================================================ -->
      <div class="tab-panel active" id="panel-template">
        <div class="card">
          <h3>出品テンプレート生成</h3>
          <p style="font-size:0.8rem;color:#888;margin-bottom:1rem;">商品情報を入力すると、AIが出品用の説明文を生成します。全項目任意ですが、入力が多いほど精度の高い説明文が生成されます。</p>

          <!-- API Key -->
          <div class="section">
            <label class="section-label">Gemini API Key</label>
            <div class="api-key-row">
              <input type="password" id="apiKeyInput" placeholder="APIキーを入力...">
              <button class="btn btn-save" id="saveKeyBtn">保存</button>
              <button class="btn btn-clear" id="clearKeyBtn">クリア</button>
            </div>
            <div class="api-key-help">
              <a id="apiKeyHelpLink">APIキーの取得方法</a>
            </div>
          </div>

          <!-- Form -->
          <div class="form-grid">
            <div class="section">
              <label class="section-label">カテゴリ</label>
              <select id="tmplCategory">
                <option value="レディース">レディース</option>
                <option value="メンズ">メンズ</option>
                <option value="ベビー・キッズ">ベビー・キッズ</option>
                <option value="家電・スマホ">家電・スマホ</option>
                <option value="本・雑誌">本・雑誌</option>
                <option value="ゲーム・おもちゃ">ゲーム・おもちゃ</option>
                <option value="コスメ・美容">コスメ・美容</option>
                <option value="スポーツ">スポーツ</option>
                <option value="インテリア・雑貨">インテリア・雑貨</option>
                <option value="その他">その他</option>
              </select>
            </div>
            <div class="section">
              <label class="section-label">商品名</label>
              <input type="text" id="tmplName" placeholder="例: ユニクロ ダウンジャケット">
            </div>
            <div class="section">
              <label class="section-label">ブランド</label>
              <input type="text" id="tmplBrand" placeholder="例: UNIQLO">
            </div>
            <div class="section">
              <label class="section-label">商品の状態</label>
              <select id="tmplCondition">
                <option value="新品・未使用">新品・未使用</option>
                <option value="未使用に近い">未使用に近い</option>
                <option value="目立った傷や汚れなし">目立った傷や汚れなし</option>
                <option value="やや傷や汚れあり">やや傷や汚れあり</option>
                <option value="傷や汚れあり">傷や汚れあり</option>
                <option value="全体的に状態が悪い">全体的に状態が悪い</option>
              </select>
            </div>
            <div class="section">
              <label class="section-label">サイズ</label>
              <input type="text" id="tmplSize" placeholder="例: L">
            </div>
            <div class="section">
              <label class="section-label">購入時期</label>
              <input type="text" id="tmplPurchaseDate" placeholder="例: 2024年冬">
            </div>
            <div class="section">
              <label class="section-label">使用頻度</label>
              <input type="text" id="tmplUsage" placeholder="例: 5回程度">
            </div>
            <div class="section">
              <label class="section-label">付属品</label>
              <input type="text" id="tmplAccessories" placeholder="例: タグ、箱">
            </div>
            <div class="section full-width">
              <label class="section-label">欠損・ダメージの説明</label>
              <input type="text" id="tmplDamage" placeholder="例: 袖口に小さな毛玉あり">
            </div>
            <div class="section">
              <label class="section-label">希望価格</label>
              <input type="number" id="tmplPrice" placeholder="例: 3000" min="0">
            </div>
            <div class="section full-width">
              <label class="section-label">参考説明文（任意）</label>
              <textarea id="tmplReference" rows="3" placeholder="他の出品者の説明文などを参考にしたい場合に入力..."></textarea>
            </div>
          </div>

          <button class="btn-primary" id="generateBtn">説明文を生成</button>
        </div>

        <!-- Generated Output -->
        <div class="card generated-output" id="generatedOutput">
          <h3>生成された説明文</h3>
          <textarea id="generatedText" placeholder="ここに生成結果が表示されます..."></textarea>
          <div class="output-actions">
            <button class="btn btn-copy" id="copyTextBtn">コピー</button>
            <a class="mercari-link" id="mercariLink" href="https://jp.mercari.com/sell" target="_blank" rel="noopener">メルカリで出品</a>
          </div>
        </div>
      </div>

      <!-- ============================================================
           Tab 2: Shipping & Profit Calculator (統合)
           ============================================================ -->
      <div class="tab-panel" id="panel-shipping">
        <div class="card">
          <h3>送料・利益計算</h3>
          <p style="font-size:0.8rem;color:#888;margin-bottom:1rem;">販売価格を入力すると利益を計算します。サイズ・重さを入力すると利用可能な配送方法に絞り込めます。</p>

          <div class="profit-input-row">
            <label>販売価格</label>
            <input type="number" id="profitPrice" placeholder="0" min="0" step="1">
            <span class="yen-suffix">円</span>
          </div>

          <div class="profit-input-row">
            <label>梱包資材</label>
            <input type="number" id="packagingCost" placeholder="0" min="0" step="1">
            <span class="yen-suffix">円</span>
          </div>

          <div class="size-inputs" style="margin-bottom:0.75rem;">
            <div class="size-input-group">
              <label>縦 (cm)</label>
              <input type="number" id="sizeH" placeholder="-" min="0" step="0.1">
            </div>
            <div class="size-input-group">
              <label>横 (cm)</label>
              <input type="number" id="sizeW" placeholder="-" min="0" step="0.1">
            </div>
            <div class="size-input-group">
              <label>厚さ (cm)</label>
              <input type="number" id="sizeD" placeholder="-" min="0" step="0.1">
            </div>
            <div class="size-input-group">
              <label>重さ (g)</label>
              <input type="number" id="sizeWeight" placeholder="-" min="0" step="1">
            </div>
          </div>

          <div class="toggle-row">
            <label class="toggle-switch">
              <input type="checkbox" id="anonymousToggle">
              <span class="toggle-slider"></span>
            </label>
            <span class="toggle-label">匿名配送のみ表示</span>
          </div>

          <div class="toggle-row">
            <label class="toggle-switch">
              <input type="checkbox" id="promoToggle">
              <span class="toggle-slider"></span>
            </label>
            <span class="toggle-label">プロモーション利用（販売価格の5%）</span>
          </div>

          <div id="shippingResults"></div>
        </div>
      </div>

      <!-- ============================================================
           Tab 4: Title Checker
           ============================================================ -->
      <div class="tab-panel" id="panel-title">
        <div class="card">
          <h3>タイトル文字数チェッカー</h3>
          <p style="font-size:0.8rem;color:#888;margin-bottom:1rem;">メルカリの商品タイトル（推奨40文字以内）の文字数をチェックします。</p>

          <div class="title-input-area">
            <input type="text" id="titleInput" maxlength="60" placeholder="商品タイトルを入力...">
          </div>

          <div class="char-count-display">
            <div class="char-count-number" id="charCountNum" style="color:#4a90d9;">0</div>
            <div class="char-count-label">文字</div>
          </div>

          <div class="progress-bar-track">
            <div class="progress-bar-fill" id="progressBar" style="width:0%;"></div>
          </div>

          <div class="char-warning" id="charWarning"></div>

          <div class="keyword-section">
            <div class="section">
              <label class="section-label">カテゴリ</label>
              <select id="keywordCategory">
                <option value="レディース">レディース</option>
                <option value="メンズ">メンズ</option>
                <option value="家電・スマホ">家電・スマホ</option>
                <option value="本・雑誌">本・雑誌</option>
                <option value="コスメ・美容">コスメ・美容</option>
                <option value="ゲーム・おもちゃ">ゲーム・おもちゃ</option>
              </select>
            </div>
            <label class="section-label">よく使うキーワード</label>
            <div class="keyword-chips" id="keywordChips"></div>
          </div>
        </div>
      </div>

      <!-- ============================================================
           Tab 5: Photo Trimmer
           ============================================================ -->
      <div class="tab-panel" id="panel-photo">
        <div class="card">
          <h3>写真トリミング</h3>
          <p style="font-size:0.8rem;color:#888;margin-bottom:1rem;">写真を正方形にクロップし、明るさ・彩度を調整してダウンロードできます。</p>

          <div class="drop-zone" id="dropZone">
            <div class="drop-zone-icon">&#128206;</div>
            <div class="drop-zone-text" id="dropZoneText">ドラッグ&ドロップ or クリックで画像を選択</div>
            <div class="drop-zone-sub">最大10枚 / JPG, PNG</div>
            <input type="file" id="photoFileInput" multiple accept="image/jpeg,image/png" style="display:none;">
          </div>

          <div class="slider-controls" id="sliderControls" style="display:none;">
            <div class="slider-group">
              <label>明るさ: <span id="brightnessVal">100</span>%</label>
              <input type="range" id="brightnessSlider" min="0" max="200" value="100">
            </div>
            <div class="slider-group">
              <label>彩度: <span id="saturationVal">100</span>%</label>
              <input type="range" id="saturationSlider" min="0" max="200" value="100">
            </div>
            <div class="slider-actions">
              <button class="btn btn-secondary" id="applyAllBtn">全画像に適用</button>
            </div>
          </div>

          <div class="photo-grid" id="photoGrid"></div>

          <div class="download-actions" id="downloadActions" style="display:none;">
            <button class="btn btn-primary" id="downloadZipBtn" style="width:auto;">ZIP一括ダウンロード</button>
            <button class="btn btn-secondary" id="downloadAllIndividual">個別ダウンロード（全て）</button>
          </div>
        </div>
      </div>
    </main>
  </div>

  <!-- FAB -->
  <button class="fab" id="fab">&#9776;</button>

  <!-- Toast -->
  <div class="toast" id="toast"></div>

  <!-- API Key Help Modal -->
  <div class="modal-overlay" id="helpModal">
    <div class="modal-content">
      <button class="modal-close" id="modalCloseBtn">&times;</button>
      <h2>Gemini APIキーの取得方法</h2>
      <ol>
        <li><a href="https://aistudio.google.com/apikey" target="_blank" rel="noopener">Google AI Studio</a> にアクセスします</li>
        <li>Googleアカウントでログインします</li>
        <li>「APIキーを作成」ボタンをクリックします</li>
        <li>プロジェクトを選択し、APIキーを生成します</li>
        <li>生成されたAPIキーをコピーします</li>
        <li>このツールの入力欄に貼り付けて「保存」を押します</li>
      </ol>
      <p class="modal-note">
        Gemini 2.5 Flash-Liteモデルは無料枠で利用できます。<br>
        APIキーはブラウザのlocalStorageにのみ保存され、外部サーバーには送信されません。
      </p>
    </div>
  </div>

  <script type="module" src="./js/main.js"></script>
</body>
</html>
